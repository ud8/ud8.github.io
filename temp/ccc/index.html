<!DOCTYPE HTML>
<html>
	<head>
		<title>Hello !</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=2.5,user-scalable=yes">
		<meta name="full-screen" content="yes">
		<meta name="browsermode" content="application">
		<meta name="x5-pagetype" content="webapp">
		<meta name="format-detection" content="telephone=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="white">
		<title>hello!</title>
		<meta name="maga" content="神推偶像登上武道館我就死而無憾">
		<script type="text/javascript" src="./assets/js/jquery-1.8.2.min.js"></script>
		<script type="text/javascript" src="./assets/js/scroll.photos.js"></script>
		<script type="text/javascript" src="./assets/js/string.format.js"></script>
	</head>
	
	<body style="background:rgb(221, 75, 92);">
		<div id="img_list">
			<style>
				img {
					max-width: 100% !important;
					height: auto !important;
				}
			</style>
		</div>
	</body>

	<script>
		var hash = window.location.hash;
		if (!hash) { hash = 0; }
		else { hash = parseInt(hash.replace("#", "")) - 1; }

		let url = location.href;
		let book = "";
		let lang = "";

		if(url.indexOf('?')!=-1) // 取得網址參數列
		{
			var ary = url.split('?')[1].split('&');
			for(i=0 ;i <ary.length; i++)
			{
				if(ary[i].split('=')[0] == 'lang')
					lang = ary[i].split('=')[1]; // 取得lang參數
				if(ary[i].split('=')[0] == 'book')
					book = ary[i].split('=')[1]; // 取得book參數
			}

			fetch('./img/{0}/b{1}.txt'.format(lang, book)) // http req到指定的檔案, .format是使用string.format.js
			.then( res => res.json() // 抓取fetch promise 轉換成json
				.then(data => {
					data.imglist.forEach(element => {
						element.url = './img/{0}/b{1}/'.format(lang, book) + element.url;   // 每一個url增加前綴(前綴是路徑 url原始是檔名)
					});
					$(document).attr("title", data.title);   // set title
					$(function () { imgscroll.beLoad($("#img_list"), data.imglist, hash); });    // 增加圖片
				})
			);
		}
	</script>
</html>